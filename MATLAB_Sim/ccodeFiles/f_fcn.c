float u = xhat(3);
float v = xhat(4);
float w = xhat(5);
float q1 = xhat(6);
float q2 = xhat(7);
float q3 = xhat(8);
float q4 = xhat(9);
float p = uk(3);
float q = uk(3);
float r = uk(3);

float t2 = q1*q1;
float t3 = q2*q2;
float t4 = q3*q3;
float t5 = q4*q4;
float  t6 = q1*q2*2.0;
float t7 = q1*q3*2.0;
float  t8 = q1*q4*2.0;
float t9 = q2*q3*2.0;
float t10 = q2*q4*2.0;
float  t11 = q3*q4*2.0;
float  t12 = -t3;
float  t13 = -t4;
float  t14 = -t5;
f(0,0) = u*(t2+t5+t12+t13)+w*(t7+t10)+v*(t6-t11);
f(1,0) = -v*(t2+t4+t12+t14)+u*(t6+t11)-w*(t8-t9);
f(2,0) = -w*(t2+t3+t13+t14)+v*(t8+t9)+u*(t7-t10);
f(3,0) = X+q1*q3*(9.8E+1/5.0)-q2*q4*(9.8E+1/5.0);
f(4,0) = Y+q1*q4*(9.8E+1/5.0)+q2*q3*(9.8E+1/5.0);
f(5,0) = Z-t2*(4.9E+1/5.0)-t3*(4.9E+1/5.0)+t4*(4.9E+1/5.0)+t5*(4.9E+1/5.0);
f(6,0) = (p*q4)/2.0-(q*q3)/2.0+(q2*r)/2.0;
f(7,0) = (p*q3)/2.0+(q*q4)/2.0-(q1*r)/2.0;
f(8,0) = p*q2*(-1.0/2.0)+(q*q1)/2.0+(q4*r)/2.0;
f(9,0) = p*q1*(-1.0/2.0)-(q*q2)/2.0-(q3*r)/2.0;
